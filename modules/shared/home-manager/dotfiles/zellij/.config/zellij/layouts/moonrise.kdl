layout {
    default_tab_template {
        pane size=1 borderless=true {
            plugin location="tab-bar" {
                hide_swap_layout_indication true
            }
        }
        children
        pane size=2 borderless=true {
            plugin location="status-bar" {
                classic true
            }
        }
    }

    tab name="agents" focus=true split_direction="horizontal" {
        pane split_direction="vertical" {
            pane name="agent-01" borderless=true command="zsh" {
                args "-lc" "env -u ZELLIJ zellij attach -c agent-01 options --default-shell nu --default-layout agent --pane-frames true --auto-layout false --session-serialization false --disable-session-metadata true"
            }
            pane name="agent-02" borderless=true command="zsh" {
                args "-lc" "env -u ZELLIJ zellij attach -c agent-02 options --default-shell nu --default-layout agent --pane-frames true --auto-layout false --session-serialization false --disable-session-metadata true"
            }
            pane name="agent-03" borderless=true command="zsh" {
                args "-lc" "env -u ZELLIJ zellij attach -c agent-03 options --default-shell nu --default-layout agent --pane-frames true --auto-layout false --session-serialization false --disable-session-metadata true"
            }
            pane name="agent-04" borderless=true command="zsh" {
                args "-lc" "env -u ZELLIJ zellij attach -c agent-04 options --default-shell nu --default-layout agent --pane-frames true --auto-layout false --session-serialization false --disable-session-metadata true"
            }
        }
        pane split_direction="vertical" {
            pane name="agent-05" borderless=true command="zsh" {
                args "-lc" "env -u ZELLIJ zellij attach -c agent-05 options --default-shell nu --default-layout agent --pane-frames true --auto-layout false --session-serialization false --disable-session-metadata true"
            }
            pane name="agent-06" borderless=true command="zsh" {
                args "-lc" "env -u ZELLIJ zellij attach -c agent-06 options --default-shell nu --default-layout agent --pane-frames true --auto-layout false --session-serialization false --disable-session-metadata true"
            }
            pane name="agent-07" borderless=true command="zsh" {
                args "-lc" "env -u ZELLIJ zellij attach -c agent-07 options --default-shell nu --default-layout agent --pane-frames true --auto-layout false --session-serialization false --disable-session-metadata true"
            }
            pane name="agent-08" borderless=true command="zsh" {
                args "-lc" "env -u ZELLIJ zellij attach -c agent-08 options --default-shell nu --default-layout agent --pane-frames true --auto-layout false --session-serialization false --disable-session-metadata true"
            }
        }
    }

    tab name="o11y" split_direction="horizontal" {
        pane split_direction="vertical" {
            pane name="btop-local" exclude_from_sync=true command="nu" {
                args "-e" "zsh -lc 'if command -v btop >/dev/null 2>&1; then btop; else echo \"btop not available\"; fi'"
            }
            pane name="docker-stats" exclude_from_sync=true command="nu" {
                args "-e" "zsh -lc 'if docker info >/dev/null 2>&1; then docker stats; else echo \"docker daemon unavailable\"; fi'"
            }
        }
        pane split_direction="vertical" {
            pane name="htop-moonrise-00" exclude_from_sync=true command="nu" {
                args "-e" "zsh -lc 'if getent hosts moonrise-labs-node-00 >/dev/null 2>&1; then TERM=xterm-256color ssh -o ConnectTimeout=4 -t moonrise-labs-node-00 htop || echo \"ssh moonrise-labs-node-00 failed\"; else echo \"moonrise-labs-node-00 unavailable (DNS unresolved)\"; fi'"
            }
            pane name="htop-moonrise-01" exclude_from_sync=true command="nu" {
                args "-e" "zsh -lc 'if getent hosts moonrise-labs-node-01 >/dev/null 2>&1; then TERM=xterm-256color ssh -o ConnectTimeout=4 -t moonrise-labs-node-01 htop || echo \"ssh moonrise-labs-node-01 failed\"; else echo \"moonrise-labs-node-01 unavailable (DNS unresolved)\"; fi'"
            }
            pane name="htop-moonrise-02" exclude_from_sync=true command="nu" {
                args "-e" "zsh -lc 'if getent hosts moonrise-labs-node-02 >/dev/null 2>&1; then TERM=xterm-256color ssh -o ConnectTimeout=4 -t moonrise-labs-node-02 htop || echo \"ssh moonrise-labs-node-02 failed\"; else echo \"moonrise-labs-node-02 unavailable (DNS unresolved)\"; fi'"
            }
        }
    }
}
